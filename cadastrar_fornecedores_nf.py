# -*- coding: utf-8 -*-
"""
Script para cadastrar fornecedores a partir de lista de notas fiscais
"""
import os
import sys
import django
import re
from decimal import Decimal

# Configurar o ambiente Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'sistema_rural.settings')
django.setup()

# Reconfigurar stdout para UTF-8
sys.stdout.reconfigure(encoding='utf-8')

from gestao_rural.models import Propriedade
from gestao_rural.models_cadastros import FornecedorCadastro

# Dados fornecidos pelo usu√°rio
dados_nf = """50231200928101000127550010000082411002146869	288357450	282255974	COMERCIO DE COMBUSTIVEL PROGRESSO LTDA	00928101000127	8241	30/12/2023	MS	750,00	0,00	0,00	A
50231205704982000116550010000390691100390694	288357450	283271124	JOSE LUIZ RETTE E CIA LTDA	05704982000116	39069	28/12/2023	MS	108,00	0,00	0,00	A
50231202935843000105558900065019541455457826	288374398	288357450	MARCELO SANGUINO	86165550134	6501954	28/12/2023	MS	29.304,60	0,00	0,00	A
35231213181164000104550010000351541995159402	288357450	177153888117	ALTERNATIVA NAUTICA LTDA	13181164000104	35154	27/12/2023	SP	45.775,00	0,00	3.204,25	A
50231221018928001579550270000008811478121194	288357450	284800023	LINEAGRO PRODUTOS AGROPECUARIO S.A	21018928001579	881	27/12/2023	MS	850,00	0,00	0,00	A
50231221018928001579550260000047731572425252	288357450	284800023	LINEAGRO PRODUTOS AGROPECUARIO S.A	21018928001579	4773	27/12/2023	MS	5.950,00	0,00	0,00	A
50231221018928000769550020000842601221553999	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	84260	19/12/2023	MS	304,00	0,00	0,00	A
50231221018928000769550020000842481575386188	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	84248	19/12/2023	MS	3.030,00	0,00	0,00	A
50231221018928000769550020000841591257445553	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	84159	19/12/2023	MS	1.600,00	0,00	140,79	A
50231202935843000105558900064834001894556753	288374398	283514531	PANTANAL LEILOES LTDA ME	10663496000137	6483400	19/12/2023	MS	97.314,30	0,00	0,00	A
35231209051623000168550010000083701000323589	000000000	513458681110	ALUMAX NAUTICA EIRELI - EPP	09051623000168	8370	18/12/2023	SP	71.099,10	0,00	0,00	A
50231200929059000169550010001042681286550752	288357450	282256563	RODOBELO DISTRIBUIDORA DE PETROLEO LTDA	00929059000169	104268	18/12/2023	MS	11.120,00	0,00	0,00	A
35231240154884000234550030009900311128704030	000000000	421105621114	STARLINK BRAZIL SERVICOS DE INTERNET LTDA.	40154884000234	990031	17/12/2023	SP	262,01	0,00	10,48	A
50231202987556000149550010005043591197547494	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	504359	16/12/2023	MS	475,00	0,00	0,00	A
35231240154884000234550030009762941126918220	000000000	421105621114	STARLINK BRAZIL SERVICOS DE INTERNET LTDA.	40154884000234	976294	15/12/2023	SP	3.150,32	0,00	220,52	A
50231221018928000769550020000831681006229188	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	83168	14/12/2023	MS	2.520,00	0,00	0,00	A
50231202987556000149550010005041861735821158	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	504186	14/12/2023	MS	284,75	0,00	48,41	A
50231202987556000149550010005041831277706259	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	504183	14/12/2023	MS	770,00	0,00	0,00	C
50231215459431001755550010006400931856530879	288357450	283937661	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001755	640093	08/12/2023	MS	2.688,40	0,00	0,00	A
50231221018928000769550020000817511052250352	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	81751	07/12/2023	MS	8.820,00	0,00	0,00	C
50231221018928000769550020000816701810013012	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	81670	07/12/2023	MS	1.600,00	0,00	0,00	A
50231215459431001321550010001457441688250250	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	145744	07/12/2023	MS	164,41	0,00	0,00	A
50231215459431001321550010001457431036326940	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	145743	07/12/2023	MS	87,00	0,00	9,18	A
50231203090842000765550010002915921362564251	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	291592	06/12/2023	MS	2.178,00	0,00	0,00	A
50231232244174000196550010000052101001722200	288357450	284356719	EMPORIO DOS FOGOES COMERCIO E SERVICOS LTDA	32244174000196	5210	06/12/2023	MS	165,00	0,00	0,00	A
50231202935843000105558900064447081641027552	288357450	288135776	NH AGROPECUARIA LTDA	27997377000385	6444708	05/12/2023	MS	715.000,00	0,00	0,00	A
50231202935843000105558900064446541134006195	288357450	287857603	ELVIO RODRIGUES/SONIA OLIVEIRA RODRIGUES	36324485072	6444654	05/12/2023	MS	1.135.200,00	0,00	0,00	A
50231224658841000159550010000369091860994608	288357450	282550704	PARAFUSOS SAO PAULO LTDA MATRIZ	24658841000159	36909	05/12/2023	MS	3.317,00	0,00	20,57	A
50231207842168000193550010000857671006771600	288357450	283378824	J M R DA SILVA E S F FRANCISCO LTDA	07842168000193	85767	04/12/2023	MS	640,00	0,00	0,00	A
50231221018928000769550020000804901466046153	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	80490	02/12/2023	MS	4.486,50	0,00	51,00	A
50231221018928000769550020000804811066283884	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	80481	02/12/2023	MS	9.000,00	0,00	0,00	A
50231202935843000105558900064368611280110946	288357450	288372662	WILSON MARTINS FERNANDES/DANIELA LOPES RICI FERNANDES	66366089191	6436861	01/12/2023	MS	200.000,00	0,00	0,00	A
50231202935843000105558900064367701270523214	288357450	286416107	JOSE FLAVIO CAMPOS NUNES	02475723149	6436770	01/12/2023	MS	32.000,00	0,00	0,00	A
50231221018928000769550020000804091452612419	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	80409	01/12/2023	MS	150,00	0,00	0,00	A
50231221018928000769550020000804081436263882	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	80408	01/12/2023	MS	1.885,00	0,00	1,50	A
50231202947844000170550010001172181010044470	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	117218	01/12/2023	MS	10.803,42	0,00	0,00	A
50231107811984000130550010004039181019569967	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403918	29/11/2023	MS	129,27	0,00	0,00	A
50231103485321000111550010000037381135317574	288374398	283126019	PIRES MARTINS & MARTINS LTDA - ME	03485321000111	3738	28/11/2023	MS	23.121,00	0,00	0,00	A
50231107811984000130550010004035341019553310	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403534	27/11/2023	MS	1.271,13	0,00	0,00	A
50231147390307002234550010001418841223621555	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	141884	27/11/2023	MS	542.000,00	0,00	0,00	A
50231107811984000130550010004035331019553291	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403533	27/11/2023	MS	729,26	0,00	0,00	A
50231147390307002234550010001418831562802946	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	141883	27/11/2023	MS	75.000,00	0,00	0,00	A
50231102987556000220550010002797531959389732	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	279753	27/11/2023	MS	448,00	0,00	20,91	A
50231107811984000130550010004035161019551999	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403516	27/11/2023	MS	1.662,23	0,00	58,55	A
50231107811984000130550010004034811019549717	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403481	27/11/2023	MS	47,43	0,00	0,00	A
50231107811984000130550010004034601019548079	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403460	27/11/2023	MS	407,27	0,00	0,00	A
50231107811984000130550010004034501019547319	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403450	25/11/2023	MS	254,52	0,00	0,00	A
50231107811984000130550010004034451019547246	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403445	25/11/2023	MS	812,85	0,00	0,00	A
50231107811984000130550010004034131019544456	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403413	25/11/2023	MS	541,10	0,00	0,00	A
50231107811984000130550010004034111019544273	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	403411	25/11/2023	MS	102,16	0,00	0,00	A
50231102987556000149550010005023581905442970	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	502358	23/11/2023	MS	198,00	0,00	0,00	A
50231102935843000105558900064109941759763550	288357450	288006372	ATHILLA FEITOSA TEODORO	02596786192	6410994	23/11/2023	MS	25.000,00	0,00	0,00	A
50231140858520000154550010000001031128643000	288357450	284568724	MARIA APARECIDA GONCALVES PEREIRA 51314924168	40858520000154	103	23/11/2023	MS	560,00	0,00	0,00	A
50231102935843000105558900064094841870118041	288357450	288317858	MARIELLI CHICARELLI ZAMARIOLI GOLINELI	28603104875	6409484	23/11/2023	MS	304.980,00	0,00	0,00	A
50231102935843000105558900064094791257941308	288357450	288317858	MARIELLI CHICARELLI ZAMARIOLI GOLINELI	28603104875	6409479	23/11/2023	MS	185.640,00	0,00	0,00	A
50231102935843000105558900064094631204780725	288357450	288313704	OLENDO GOLINELI JUNIOR	26711946847	6409463	23/11/2023	MS	331.500,00	0,00	0,00	A
50231102935843000105558900064094451158386359	288357450	288317858	MARIELLI CHICARELLI ZAMARIOLI GOLINELI	28603104875	6409445	23/11/2023	MS	318.240,00	0,00	0,00	A
50231102935843000105558900064094551346489565	288357450	288313704	OLENDO GOLINELI JUNIOR	26711946847	6409455	23/11/2023	MS	185.640,00	0,00	0,00	A
50231102935843000105558900064066191879804400	288374398	283514531	PANTANAL LEILOES LTDA ME	10663496000137	6406619	22/11/2023	MS	11.197,44	0,00	0,00	A
50231147390307002234550010001416201698874530	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	141620	20/11/2023	MS	969,03	0,00	164,74	A
50231177941490001712550010001843101004195153	000000000	282920781	GAZIN INDUSTRIA E COMERCIO DE MOVEIS E ELETRODOMESTICOS S.A	77941490001712	184310	16/11/2023	MS	14,90	0,00	2,53	A
50231115565260000181550060000055601341303444	288357450	282158502	MACAL AGRO SOLUCOES	15565260000181	5560	15/11/2023	MS	33.565,00	0,00	0,00	A
50231115565260000181550060000055571411387670	288357450	282158502	MACAL AGRO SOLUCOES	15565260000181	5557	15/11/2023	MS	29.729,00	0,00	0,00	A
50231107811984000130550010004022701019484454	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	402270	14/11/2023	MS	6.828,49	0,00	0,00	A
50231115459431001321550010001450831826483820	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	145083	13/11/2023	MS	1.559,77	0,00	33,69	A
50231102935843000105558900063830281915149933	288374398	288361431	JOEL DE SOUZA MELO	90166922153	6383028	13/11/2023	MS	38.000,00	0,00	0,00	A
50231103583836000154550000005409551588529393	000000000	283120975	Kampai Motors Ltda	03583836000154	540955	13/11/2023	MS	12.659,44	0,00	0,00	A
50231147960950007991550020001272451087700280	000000000	282968520	MAGAZINE LUIZA S/A	47960950007991	127245	11/11/2023	MS	1.168,90	0,00	0,00	A
50231103090842000765550010002896641423442835	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	289664	11/11/2023	MS	910,00	0,00	0,00	A
50231136777076000256550010000653461000642692	288357450	282729704	VEIPECAS COMERCIO IMPORTACAO LTDA	36777076000256	65346	11/11/2023	MS	15,00	0,00	0,00	A
50231156992951002273550020002171081552451164	288357450	282317716	DSM Produtos Nutricionais Brasil SA	56992951002273	217108	10/11/2023	MS	16.477,81	0,00	0,00	A
50231107811984000130550010004019211019464584	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401921	10/11/2023	MS	16,74	0,00	0,00	A
50231107811984000130550010004019201019464579	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401920	10/11/2023	MS	310,74	0,00	0,00	A
50231107811984000130550010004019181019464546	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401918	10/11/2023	MS	24,89	0,00	0,00	A
50231107811984000130550010004019161019464509	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401916	10/11/2023	MS	283,63	0,00	0,00	A
50231107811984000130550010004019131019464450	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401913	10/11/2023	MS	763,79	0,00	0,00	A
50231102935843000105558900063762021029774728	288357450	287142604	RONALDO SERGIO MARTINS GUIMARAES/BRUNA DE BARROS ALBANEZE GU	45689024104	6376202	10/11/2023	MS	540.000,00	0,00	0,00	A
50231102935843000105558900063704711216873336	288357450	287142604	RONALDO SERGIO MARTINS GUIMARAES/BRUNA DE BARROS ALBANEZE GU	45689024104	6370471	08/11/2023	MS	630.000,00	0,00	0,00	A
50231115459431001321550010001449131330790198	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	144913	07/11/2023	MS	515,89	0,00	0,00	A
50231121018928000769550020000749741005804527	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	74974	06/11/2023	MS	58.000,00	0,00	0,00	A
50231107811984000130550010004010621019428492	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401062	06/11/2023	MS	663,02	0,00	103,02	A
50231107811984000130550010004010611019428487	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	401061	06/11/2023	MS	730,25	0,00	0,00	A
50231132244174000196550010000051141001209244	288357450	284356719	EMPORIO DOS FOGOES COMERCIO E SERVICOS LTDA	32244174000196	5114	04/11/2023	MS	2.746,00	0,00	0,00	A
50231102987556000220550010002784271550907856	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	278427	04/11/2023	MS	160,00	0,00	7,60	A
50231103583836000154550000005398371143648373	000000000	283120975	Kampai Motors Ltda	03583836000154	539837	03/11/2023	MS	2.140,70	0,00	20,23	A
50231102935843000105558900063553841166519710	288374398	288531329	LAURINDO CLEBER LOPES DA SILVA/ANA FABIA VAZ VIEIRA DA SILVA	16450337168	6355384	01/11/2023	MS	51.800,00	0,00	0,00	A
50231102935843000105558900063553811318879143	288374398	288531329	LAURINDO CLEBER LOPES DA SILVA/ANA FABIA VAZ VIEIRA DA SILVA	16450337168	6355381	01/11/2023	MS	51.800,00	0,00	0,00	A
50231126937676000108550010000107581209268964	288357450	284208906	BOREAL VEICULOS E NAUTICOS LTDA	26937676000108	10758	01/11/2023	MS	144.990,00	0,00	0,00	A
50231102987556000220550010002782621381960419	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	278262	01/11/2023	MS	45,00	0,00	0,00	A
50231121018928001579550260000031611623031106	288357450	284800023	LINEAGRO PRODUTOS AGROPECUARIO S.A	21018928001579	3161	01/11/2023	MS	5.900,10	0,00	0,00	A
50231121018928001579550270000007171385625150	288357450	284800023	LINEAGRO PRODUTOS AGROPECUARIO S.A	21018928001579	717	01/11/2023	MS	754,30	0,00	0,00	A
50231121018928000769550020000742041794185828	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	74204	01/11/2023	MS	775,00	0,00	0,00	A
50231103746864000811550030000070261917154444	288357450	284557900	IMESUL METALURGICA LTDA	03746864000811	7026	01/11/2023	MS	612,00	0,00	104,04	A
50231107811984000130550010004006791019407814	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400679	01/11/2023	MS	17,43	0,00	0,00	A
50231107811984000130550010004006541019405553	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400654	01/11/2023	MS	281,55	0,00	0,00	A
50231107811984000130550010004006501019405260	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400650	01/11/2023	MS	281,53	0,00	0,00	A
50231107811984000130550010004006491019405243	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400649	01/11/2023	MS	2.352,90	0,00	34,71	A
50231102947844000170550010001160241009842846	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	116024	01/11/2023	MS	10.294,31	0,00	0,00	A
50231107811984000130550010004006381019404782	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400638	01/11/2023	MS	11.023,25	0,00	693,72	A
50231002298030000151550010001130831486367892	288374398	283028238	FRANCA COMERCIAL DE ALIMENTOS LTDA.	02298030000151	113083	31/10/2023	MS	61.594,05	0,00	0,00	A
35231005162045001239550020000379831336472791	288357450	224326947110	LAGOA DA SERRA LTDA	05162045001239	37983	31/10/2023	SP	40.000,00	0,00	0,00	A
50231015565260000181550060000052971781631806	288357450	282158502	MACAL AGRO SOLUCOES	15565260000181	5297	31/10/2023	MS	57.540,00	0,00	0,00	A
50231015565260000181550060000052911283463193	288357450	282158502	MACAL AGRO SOLUCOES	15565260000181	5291	31/10/2023	MS	51.786,00	0,00	0,00	A
50231015565260000181550060000052881495201944	288357450	282158502	MACAL AGRO SOLUCOES	15565260000181	5288	31/10/2023	MS	172.620,00	0,00	0,00	A
50231003090842000765550010002887491365064331	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	288749	30/10/2023	MS	120,00	0,00	0,00	A
50231040858520000154550010000001001288144480	288357450	284568724	MARIA APARECIDA GONCALVES PEREIRA 51314924168	40858520000154	100	30/10/2023	MS	560,00	0,00	0,00	A
50231015459431001321550010001446901803595000	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	144690	30/10/2023	MS	1.068,88	0,00	0,00	A
50231007811984000130550010004004531019395009	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	400453	30/10/2023	MS	14.000,00	0,00	0,00	A
50231002987556000149550010005000991873386322	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	500099	28/10/2023	MS	755,00	0,00	0,00	A
50231004210796000168550010000123981371300001	288357450	283164247	COMILHO PRODUTOS AGROPECUARIOS LTDA	04210796000168	12398	27/10/2023	MS	150,00	0,00	0,00	A
50231003746864000811550030000069591610968825	288357450	284557900	IMESUL METALURGICA LTDA	03746864000811	6959	26/10/2023	MS	4.896,00	0,00	832,32	A
50231003485321000111550010000036901578218371	288374398	283126019	PIRES MARTINS & MARTINS LTDA - ME	03485321000111	3690	26/10/2023	MS	15.594,00	0,00	0,00	A
50231007811984000130550010003997701019365078	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	399770	25/10/2023	MS	200,79	0,00	0,00	A
50231002935843000105558900063326661154293554	288357450	286251558	NOBERTO SOARES LEITE/CELINA MICHIKO ARAKAKI LEITE	08031320187	6332666	25/10/2023	MS	365,00	0,00	0,00	A
50231021018928000769550020000724321604818541	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	72432	23/10/2023	MS	8.010,00	0,00	0,00	A
50231007842168000193550010000835991006670109	288357450	283378824	J M R DA SILVA E S F FRANCISCO LTDA	07842168000193	83599	23/10/2023	MS	600,00	0,00	0,00	A
35231037176287000115550010000017141005495375	288357450	330057290111	KATAYAMA AGRONEGOCIOS LTDA	37176287000115	1714	23/10/2023	SP	179.924,32	0,00	0,00	A
35231037176287000115550010000017131005495360	288357450	330057290111	KATAYAMA AGRONEGOCIOS LTDA	37176287000115	1713	23/10/2023	SP	425.275,68	0,00	0,00	A
50231021018928000769550020000716911346795924	288374398	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	71691	19/10/2023	MS	0,00	0,00	0,00	A
50231021018928000769550020000716881075312609	288374398	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	71688	19/10/2023	MS	3.937,50	0,00	0,00	A
50231036777076000256550010000647351000636587	288357450	282729704	VEIPECAS COMERCIO IMPORTACAO LTDA	36777076000256	64735	19/10/2023	MS	61,50	0,00	0,00	A
50231040858520000154550010000000981523697960	288357450	284568724	MARIA APARECIDA GONCALVES PEREIRA 51314924168	40858520000154	98	19/10/2023	MS	160,00	0,00	0,00	A
50231002935843000105558900063158661182695685	288357450	288511980	CLAUDIO BERGMANN	88631605972	6315866	18/10/2023	MS	1.496.000,00	0,00	0,00	A
50231002987556000220550010002773221014256973	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	277322	18/10/2023	MS	413,84	0,00	37,40	A
50231047390307002234550010001404561190915135	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	140456	16/10/2023	MS	75.000,00	0,00	4.200,00	A
50231047390307002234550010001404531121020076	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	140453	16/10/2023	MS	124.000,00	0,00	6.944,00	A
50231047390307002234550010001404451724011026	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	140445	16/10/2023	MS	542.000,00	0,00	30.352,02	A
50231047390307002234550010001404411236601437	288357450	283226706	SHARK TRATORES E PECAS LTDA	47390307002234	140441	16/10/2023	MS	542.000,00	0,00	30.352,02	A
50231015459431001321550010001441711541934811	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	144171	13/10/2023	MS	1.861,38	0,00	0,00	A
50231005345540000120550010003685171003380819	288357450	283238143	AUTO PECAS BRASIL IMPORT LTDA - ME	05345540000120	368517	10/10/2023	MS	1.600,00	0,00	0,00	A
41231072166010000102550010000382951675369607	000000000	4101321504	MET. VOCAL LTDA EPP	72166010000102	38295	09/10/2023	PR	10.066,88	0,00	704,68	A
50231002935843000105558900062922411991790232	288374398	283514531	PANTANAL LEILOES LTDA ME	10663496000137	6292241	08/10/2023	MS	33.515,43	0,00	0,00	A
50231003479372000130550020000038911658400003	288357450	283114967	DULCINETE ROSA DA COSTA	03479372000130	3891	07/10/2023	MS	1.500,00	0,00	0,00	A
50231007811984000130550010003976991019264119	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	397699	05/10/2023	MS	573,98	0,00	0,00	A
50231007811984000130550010003976981019264103	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	397698	05/10/2023	MS	215,65	0,00	0,00	A
50231007811984000130550010003976971019264092	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	397697	05/10/2023	MS	9,91	0,00	0,00	A
50231007811984000130550010003976211019261958	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	397621	05/10/2023	MS	29,69	0,00	0,00	A
50231021018928000769550020000691161969989972	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	69116	05/10/2023	MS	58.000,00	0,00	0,00	A
50231021018928000769550020000690071872110297	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	69007	04/10/2023	MS	2.030,32	0,00	11,48	A
50231021018928000769550020000685821322036989	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	68582	02/10/2023	MS	60.030,32	0,00	0,00	A
50231002947844000170550010001147831009632937	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	114783	02/10/2023	MS	1.017,56	0,00	0,00	A
50230940858520000154550010000000971802758276	288357450	284568724	MARIA APARECIDA GONCALVES PEREIRA 51314924168	40858520000154	97	30/09/2023	MS	120,00	0,00	0,00	A
50230902987556000220550010002762641833534198	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	276264	30/09/2023	MS	359,00	0,00	6,05	A
50230915459431001321550010001438211222616202	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	143821	29/09/2023	MS	2.332,65	0,00	42,59	A
50230907811984000130550010003966561019220551	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	396656	28/09/2023	MS	30,47	0,00	0,00	A
50230907811984000130550010003963561019204525	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	396356	26/09/2023	MS	3.293,87	0,00	0,00	A
50230915925449000723550040000591301088530497	288374398	283824093	TRATORNAN MAQ.IMPLEM.E EQUIPAMENTOS LTDA	15925449000723	59130	26/09/2023	MS	1.670,00	0,00	0,00	A
50230928054896000100550010000761691034303426	288357450	284231495	JA COMERCIO DE ARTIGOS PARA ESCRITORIO LTDA	28054896000100	76169	25/09/2023	MS	24,65	0,00	0,00	A
50230928054896000100550010000761671930008960	288357450	284231495	JA COMERCIO DE ARTIGOS PARA ESCRITORIO LTDA	28054896000100	76167	25/09/2023	MS	176,21	0,00	0,00	A
50230903583836000154550000005347281853810167	000000000	283120975	Kampai Motors Ltda	03583836000154	539837	25/09/2023	MS	2.140,70	0,00	20,23	A
50230407811984000130550010003807961018403662	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	380796	27/04/2023	MS	134,28	0,00	0,00	A
50230407811984000130550010003807941018403633	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	380794	27/04/2023	MS	117,29	0,00	0,00	A
50230407811984000130550010003807931018403601	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	380793	27/04/2023	MS	1.063,06	0,00	0,00	A
50230407811984000130550010003807921018403558	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	380792	27/04/2023	MS	1.224,79	0,00	0,00	A
50230403090842000765550010002741511053657235	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	274151	27/04/2023	MS	14.155,00	0,00	19,93	A
50230403090842000765550010002741401120587139	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	274140	27/04/2023	MS	13.933,00	0,00	0,00	A
50230402987556000220550010002656821423167393	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	265682	27/04/2023	MS	237,00	0,00	0,00	A
50230403090842000765550010002740801647113129	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	274080	26/04/2023	MS	3.064,36	0,00	0,00	A
50230403090842000765550010002740781084128526	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	274078	26/04/2023	MS	210,00	0,00	0,00	A
50230402987556000220550010002656661994319744	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	265666	26/04/2023	MS	168,00	0,00	0,00	C
50230403090842000765550010002740571265241405	288357450	282895850	TRACTOR PARTS DISTRIB. DE AUTO PECAS LTDA.	03090842000765	274057	26/04/2023	MS	11.078,64	0,00	0,00	A
50230402987556000220550010002654021700062556	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	265402	24/04/2023	MS	530,00	0,00	0,00	A
50230402987556000220550010002651681790772855	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	265168	19/04/2023	MS	226,80	0,00	0,00	A
50230402935843000105558900058273031110429970	288374398	288357450	MARCELO SANGUINO	86165550134	5827303	16/04/2023	MS	114.509,00	0,00	0,00	A
50230402935843000105558900058273021163524511	288374398	288357450	MARCELO SANGUINO	86165550134	5827302	16/04/2023	MS	114.509,00	0,00	0,00	A
50230402935843000105558900058273011094584550	288374398	288357450	MARCELO SANGUINO	86165550134	5827301	16/04/2023	MS	94.331,52	0,00	0,00	A
50230402935843000105558900058273001777927369	288374398	288357450	MARCELO SANGUINO	86165550134	5827300	16/04/2023	MS	94.331,52	0,00	0,00	A
50230402935843000105558900058272981440344313	288374398	288357450	MARCELO SANGUINO	86165550134	5827298	16/04/2023	MS	92.551,68	0,00	0,00	A
50230402935843000105558900058272971189077235	288374398	288357450	MARCELO SANGUINO	86165550134	5827297	16/04/2023	MS	36.173,28	0,00	0,00	A
50230402935843000105558900058272951380016593	288374398	288357450	MARCELO O SANGUINO	86165550134	5827295	16/04/2023	MS	34.045,44	0,00	0,00	A
50230402935843000105558900058272941896593716	288374398	288357450	MARCELO SANGUINO	86165550134	5827294	16/04/2023	MS	13.749,12	0,00	0,00	A
50230402935843000105558900058272911638087387	288374398	288357450	MARCELO SANGUINO	86165550134	5827291	16/04/2023	MS	11.273,16	0,00	0,00	A
50230402935843000105558900058125401049635941	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5812540	11/04/2023	MS	122.000,00	0,00	0,00	A
50230402935843000105558900058125341390043270	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5812534	11/04/2023	MS	122.000,00	0,00	0,00	A
50230402935843000105558900058125211158776710	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5812521	11/04/2023	MS	61.000,00	0,00	0,00	A
50230407842168000193550010000752271006244454	288357450	283378824	J M R DA SILVA E S F FRANCISCO LTDA	07842168000193	75227	10/04/2023	MS	1.155,00	0,00	0,00	A
50230402916265007768550040000944271306229651	288374398	282993096	JBS S/A	02916265007768	94427	10/04/2023	MS	276.141,73	0,00	0,00	A
50230407811984000130550010003789581018310942	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	378958	06/04/2023	MS	7.200,00	0,00	0,00	A
50230416039489000145550050000000101810968550	288374398	284538930	BETA CARNES ALIMENTOS EIRELI	16039489000145	10	06/04/2023	MS	81.908,99	0,00	0,00	A
50230403911771000129550010003331951370841248	288357450	283139315	PRO RURAL PRODUTOS AGROPECUARIOS LTDA	03911771000129	333195	05/04/2023	MS	280,00	0,00	9,35	A
50230402987556000220550010002642021808007860	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	264202	04/04/2023	MS	1.523,00	0,00	14,96	A
50230402935843000105558900057972231097172672	288374398	288357450	MARCELO SANGUINO	86165550134	5797223	04/04/2023	MS	33.163,00	0,00	0,00	A
50230303911771000129550010003327711086651025	288357450	283139315	PRO RURAL PRODUTOS AGROPECUARIOS LTDA	03911771000129	332771	30/03/2023	MS	268,00	0,00	0,00	A
50230303911771000129550010003327691389095660	288357450	283139315	PRO RURAL PRODUTOS AGROPECUARIOS LTDA	03911771000129	332769	30/03/2023	MS	190,00	0,00	0,00	C
50230321018928000769550020000316821872033673	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	31682	23/03/2023	MS	1.716,40	0,00	22,10	A
50230302030328000186550010000006941745048753	288357450	282427449	RETIFICADORA PROGRESSO LTDA EPP	02030328000186	694	16/03/2023	MS	4.248,00	0,00	0,00	A
50230302030328000186550010000006931474202991	288357450	282427449	RETIFICADA PROGRESSO LTDA EPP	02030328000186	693	16/03/2023	MS	1.464,00	0,00	0,00	A
50230302987556000220550010002628351339731210	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	262835	15/03/2023	MS	758,00	0,00	0,00	A
50230302916265007768550040000937931080874849	288374398	282993096	JBS S/A	02916265007768	93793	10/03/2023	MS	73.722,79	0,00	0,00	A
50230307811984000130550010003765701018174780	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	376570	09/03/2023	MS	158,26	0,00	0,00	A
50230302987556000220550010002618851628168694	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	261885	01/03/2023	MS	1.164,00	0,00	0,00	A
50230302987556000220550010002618751564211539	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	261875	01/03/2023	MS	192,00	0,00	0,00	C
50230302947844000170550010001067731008316095	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	106773	01/03/2023	MS	240,03	0,00	0,00	A
50230203086339000140550010000046561000835165	288374398	283083123	SCHREINER E SCHEREINER LTDA - ME	03086339000140	4656	14/02/2023	MS	491,83	0,00	0,00	A
50230202987556000220550010002598681995753211	288374398	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	259868	02/02/2023	MS	809,00	0,00	56,06	A
50230202947844000170550010001058231008154120	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	105823	01/02/2023	MS	1.351,28	0,00	0,00	A
50230101851420000225550010001001771137580046	288374398	282995501	2 - BEUX PECAS E MOTORES LTDA	01851420000225	100177	31/01/2023	MS	1.850,00	0,00	0,00	A
50230102916265007768550040000929271373224680	288374398	282993096	JBS S/A	02916265007768	92927	30/01/2023	MS	179.437,45	0,00	0,00	A
50230102987556000220550010002595441690305620	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	259544	28/01/2023	MS	200,00	0,00	0,00	A
50230102987556000220550010002595421137882844	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	259542	28/01/2023	MS	235,00	0,00	0,00	C
50230115459431001321550010001372101799762783	288357450	283581115	SERTAO COMERCIAL DE EQUIPAMENTOS LTDA	15459431001321	137210	26/01/2023	MS	408,71	0,00	5,10	A
50230105808085000152550010003776841597624027	288357450	283292121	BRASCAMPO PRODUTOS AGROPECUARIOS LTDA	05808085000152	377684	26/01/2023	MS	120,00	0,00	20,40	A
50230102935843000105558900056274351899726257	288374398	282734597	CORREA DA COSTA EVENTOS RURAIS LTDA EPP	37180064000121	5627435	26/01/2023	MS	64.007,70	0,00	0,00	A
50230102935843000105558900056225891644278961	288374398	288357450	MARCELO SANGUINO	86165550134	5622589	24/01/2023	MS	12.181,80	0,00	0,00	A
50230107811984000130550010003727621017957024	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	372762	21/01/2023	MS	68,26	0,00	0,00	A
50230107811984000130550010003727611017957019	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	372761	21/01/2023	MS	231,30	0,00	0,00	A
50230102935843000105558900056162271811252938	288374398	288150236	TANIA BERNARDES DE OLIVEIRA MELO/ALEXANDRE FERREIRA FIALHO	87229870100	5616227	20/01/2023	MS	2.020,00	0,00	0,00	A
50230102935843000105558900056162221234528665	288374398	288182308	OTANAZILDO BALDUINO DE OLIVEIRA	02720937185	5616222	20/01/2023	MS	6.750,00	0,00	0,00	A
50230102935843000105558900056162171248039637	288374398	288435915	LARISSA MARIA CAMPOS JUDICE	07210731156	5616217	20/01/2023	MS	11.400,00	0,00	0,00	A
50230102935843000105558900056162111402328040	288374398	288522052	EDSON VIEIRA DO AMARAL	89057155168	5616211	20/01/2023	MS	28.800,00	0,00	0,00	A
50230102935843000105558900056162061192694860	288374398	287258726	CLOVIS GONCALVES AMORIM	25749765172	5616206	20/01/2023	MS	2.400,00	0,00	0,00	A
50230102935843000105558900056162011765118441	288374398	288043880	BEATRIZ DA SILVA BORGES	08231565167	5616201	20/01/2023	MS	6.360,00	0,00	0,00	A
50230102935843000105558900056159931595676320	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5615993	20/01/2023	MS	4.060,00	0,00	0,00	A
50230102935843000105558900056159861271078318	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5615986	20/01/2023	MS	4.060,00	0,00	0,00	A
50230102935843000105558900056155881063889875	288374398	288419367	ANDERSON JOSE BENEDET	96084960120	5615588	20/01/2023	MS	31.980,00	0,00	0,00	A
50230107811984000130550010003722541017931450	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	372254	18/01/2023	MS	574,08	0,00	0,00	A
50230102987556000220550010002584921270383693	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	258492	13/01/2023	MS	244,28	0,00	0,00	A
50230102987556000220550010002584611088433560	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	258461	12/01/2023	MS	95,72	0,00	0,00	A
50230102987556000220550010002584601278170768	288357450	283378093	NUTRIBEM PRODUTOS AGROPECUARIOS LTDA	02987556000220	258460	12/01/2023	MS	340,00	0,00	0,00	A
50230121018928000769550020000174611341178532	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	17461	12/01/2023	MS	839,00	0,00	0,00	A
50230107811984000130550010003718661017909755	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371866	12/01/2023	MS	864,84	0,00	0,00	A
50230107811984000130550010003718461017908993	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371846	12/01/2023	MS	51,35	0,00	0,00	A
50230102987556000149550010004714441922297512	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	471444	10/01/2023	MS	78,00	0,00	0,00	A
50230107811984000130550010003715061017890812	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371506	09/01/2023	MS	1.626,57	0,00	0,00	A
50230107811984000130550010003715051017890785	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371505	09/01/2023	MS	3.951,83	0,00	0,00	A
50230107811984000130550010003715041017890702	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371504	09/01/2023	MS	1.301,40	0,00	221,24	A
50230102916265007768550040000924021644618640	288374398	282993096	JBS S/A	02916265007768	92402	07/01/2023	MS	192.868,88	0,00	0,00	A
50230107811984000130550010003711671017876457	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371167	06/01/2023	MS	94,15	0,00	0,00	A
50230107811984000130550010003710911017873547	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371091	05/01/2023	MS	1.496,19	0,00	0,00	A
50230107811984000130550010003710901017873477	288357450	283376732	CONSTRUIR MATERIAIS DE CONSTRUCAO LTDA	07811984000130	371090	05/01/2023	MS	1.496,19	0,00	0,00	C
50230102987556000149550010004707431733140980	288374398	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	470743	04/01/2023	MS	830,00	0,00	0,00	A
50230102987556000149550010004706941900086800	288357450	283077697	NUTRIBEM PROD AGRO LTDA	02987556000149	470694	04/01/2023	MS	29,90	0,00	5,08	A
50230121018928000769550020000153151075353164	288357450	284734934	LINEAGRO PRODUTOS AGROPECUARIOS SA	21018928000769	15315	02/01/2023	MS	214,50	0,00	0,00	A
50230102947844000170550010001048081007978770	288357450	282402098	MARIO DA F. P DA SILVA & CIA LTDA	02947844000170	104808	02/01/2023	MS	1.351,28	0,00	0,00	A"""

def formatar_cnpj_cpf(valor):
    """Formata CNPJ/CPF removendo caracteres especiais e adicionando formata√ß√£o"""
    if not valor or valor == '000000000':
        return None
    # Remove caracteres n√£o num√©ricos
    valor_limpo = re.sub(r'\D', '', str(valor))
    if len(valor_limpo) == 11:
        # CPF: 000.000.000-00
        return f"{valor_limpo[:3]}.{valor_limpo[3:6]}.{valor_limpo[6:9]}-{valor_limpo[9:]}"
    elif len(valor_limpo) == 14:
        # CNPJ: 00.000.000/0000-00
        return f"{valor_limpo[:2]}.{valor_limpo[2:5]}.{valor_limpo[5:8]}/{valor_limpo[8:12]}-{valor_limpo[12:]}"
    return valor_limpo

def determinar_tipo_fornecedor(nome):
    """Determina o tipo de fornecedor baseado no nome"""
    nome_upper = nome.upper()
    
    if any(palavra in nome_upper for palavra in ['RACAO', 'NUTRI', 'ALIMENTO', 'RA√á√ÉO', 'SUPLEMENTO']):
        return 'RACAO'
    elif any(palavra in nome_upper for palavra in ['MEDICAMENTO', 'VETERINARIO', 'VETERIN√ÅRIO', 'VACINA']):
        return 'MEDICAMENTO'
    elif any(palavra in nome_upper for palavra in ['TRATOR', 'EQUIPAMENTO', 'PECA', 'PE√áA', 'MAQUINA', 'M√ÅQUINA', 'VEICULO', 'VE√çCULO']):
        return 'EQUIPAMENTO'
    elif any(palavra in nome_upper for palavra in ['COMBUSTIVEL', 'COMBUST√çVEL', 'PETROLEO', 'PETR√ìLEO', 'DIESEL', 'GASOLINA']):
        return 'COMBUSTIVEL'
    elif any(palavra in nome_upper for palavra in ['CONSTRUCAO', 'CONSTRU√á√ÉO', 'MATERIAL', 'CONSTRUIR']):
        return 'CONSTRUCAO'
    elif any(palavra in nome_upper for palavra in ['TRANSPORTE', 'FRETE', 'LOGISTICA', 'LOG√çSTICA']):
        return 'TRANSPORTE'
    elif any(palavra in nome_upper for palavra in ['SERVICO', 'SERVI√áO', 'INTERNET', 'TELECOM']):
        return 'SERVICO'
    else:
        return 'OUTROS'

def processar_linha(linha):
    """Processa uma linha de dados e extrai informa√ß√µes do fornecedor"""
    campos = linha.split('\t')
    if len(campos) < 5:
        # Tentar separar por m√∫ltiplos espa√ßos
        campos = re.split(r'\s{2,}', linha.strip())
    
    # Estrutura esperada: Chave NF | IE Dest | IE Emit | Raz√£o Social | CNPJ/CPF | N¬∫ NF | Data | UF | Total | Base ICMS | ICMS | Situa√ß√£o
    if len(campos) >= 5:
        try:
            razao_social = campos[3].strip() if len(campos) > 3 else ''
            cnpj_cpf = campos[4].strip() if len(campos) > 4 else ''
            uf = campos[7].strip() if len(campos) > 7 else 'MS'
            
            # Ignorar linhas inv√°lidas
            if not razao_social or not cnpj_cpf or cnpj_cpf == '000000000':
                return None
            
            return {
                'nome': razao_social,
                'cpf_cnpj': formatar_cnpj_cpf(cnpj_cpf),
                'estado': uf,
                'tipo': determinar_tipo_fornecedor(razao_social),
            }
        except (IndexError, ValueError) as e:
            return None
    return None

def cadastrar_fornecedores():
    """Cadastra fornecedores a partir dos dados fornecidos"""
    # Buscar propriedade (Marcelo Sanguino / Fazenda Canta Galo)
    propriedade = Propriedade.objects.filter(
        nome_propriedade__icontains='Canta Galo'
    ).first()
    
    if not propriedade:
        print("‚ùå ERRO: Propriedade 'Fazenda Canta Galo' n√£o encontrada!")
        print("   Verifique se est√° usando o banco de dados correto.")
        return
    
    print("=" * 60)
    print("CADASTRO DE FORNECEDORES A PARTIR DE NOTAS FISCAIS")
    print("=" * 60)
    print(f"Propriedade: {propriedade.nome_propriedade}")
    print()
    
    # Processar linhas
    linhas = dados_nf.strip().split('\n')
    fornecedores_unicos = {}
    
    for linha in linhas:
        if not linha.strip() or linha.strip().startswith('Chave') or linha.strip().startswith('Inf.'):
            continue
        
        dados = processar_linha(linha)
        if dados and dados['cpf_cnpj']:
            # Usar CNPJ/CPF como chave √∫nica
            cnpj_cpf_limpo = re.sub(r'\D', '', dados['cpf_cnpj'])
            if cnpj_cpf_limpo not in fornecedores_unicos:
                fornecedores_unicos[cnpj_cpf_limpo] = dados
            else:
                # Se j√° existe, atualizar tipo se necess√°rio (priorizar tipos mais espec√≠ficos)
                tipo_atual = fornecedores_unicos[cnpj_cpf_limpo]['tipo']
                tipo_novo = dados['tipo']
                if tipo_atual == 'OUTROS' and tipo_novo != 'OUTROS':
                    fornecedores_unicos[cnpj_cpf_limpo]['tipo'] = tipo_novo
    
    print(f"üìä Total de fornecedores √∫nicos encontrados: {len(fornecedores_unicos)}")
    print()
    
    # Cadastrar fornecedores
    cadastrados = 0
    atualizados = 0
    erros = 0
    
    for cnpj_cpf_limpo, dados in fornecedores_unicos.items():
        try:
            # Verificar se j√° existe
            fornecedor_existente = FornecedorCadastro.objects.filter(
                cpf_cnpj=dados['cpf_cnpj']
            ).first()
            
            if fornecedor_existente:
                print(f"‚è≠Ô∏è  J√° existe: {dados['nome']} ({dados['cpf_cnpj']})")
                atualizados += 1
            else:
                # Criar novo fornecedor
                fornecedor = FornecedorCadastro.objects.create(
                    propriedade=propriedade,
                    nome=dados['nome'],
                    cpf_cnpj=dados['cpf_cnpj'],
                    tipo=dados['tipo'],
                    estado=dados['estado'],
                    ativo=True,
                )
                print(f"‚úÖ Cadastrado: {dados['nome']} ({dados['cpf_cnpj']}) - {fornecedor.get_tipo_display()}")
                cadastrados += 1
        except Exception as e:
            print(f"‚ùå Erro ao cadastrar {dados['nome']}: {e}")
            erros += 1
    
    print()
    print("=" * 60)
    print("RESUMO")
    print("=" * 60)
    print(f"‚úÖ Cadastrados: {cadastrados}")
    print(f"‚è≠Ô∏è  J√° existiam: {atualizados}")
    print(f"‚ùå Erros: {erros}")
    print(f"üìä Total processado: {len(fornecedores_unicos)}")
    print()

if __name__ == '__main__':
    cadastrar_fornecedores()


