# === DIAGNÓSTICO COMPLETO DO ERRO 502 ===
# Execute linha por linha no Console Web da Locaweb

echo "=== 1. VERIFICANDO SE DJANGO ESTÁ RODANDO ==="
ps aux | grep python | grep runserver

echo "=== 2. VERIFICANDO PORTAS EM USO ==="
ss -tlnp | grep 8000

echo "=== 3. TESTANDO CONEXÃO LOCAL ==="
curl -I http://127.0.0.1:8000/

echo "=== 4. VERIFICANDO LOGS DO DJANGO ==="
tail -20 /tmp/django.log

echo "=== 5. VERIFICANDO NGINX ==="
systemctl status nginx

echo "=== 6. VERIFICANDO LOGS DO NGINX ==="
tail -10 /var/log/nginx/error.log

echo "=== 7. VERIFICANDO CONFIGURAÇÃO DO NGINX ==="
cat /etc/nginx/sites-available/monpec.com.br

echo "=== 8. TESTANDO SINTAXE DO URLS.PY ==="
cd /var/www/monpec.com.br
python manage.py check

echo "=== 9. VERIFICANDO VIEWS.PY ==="
python -c "from gestao_rural import views; print('Views OK')"

echo "=== 10. TENTANDO INICIAR DJANGO MANUALMENTE ==="
cd /var/www/monpec.com.br
source venv/bin/activate
python manage.py runserver 127.0.0.1:8000

# Este comando vai ficar executando - se der erro, pare com Ctrl+C
