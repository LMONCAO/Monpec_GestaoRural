# Comandos para verificar o erro completo do job de migração

# 1. Ver a última execução do job
gcloud run jobs executions list --job migrate-monpec --region us-central1 --limit 1

# 2. Ver logs completos do job (últimos 50)
gcloud logging read "resource.type=cloud_run_job AND resource.labels.job_name=migrate-monpec AND resource.labels.location=us-central1" \
    --limit 100 \
    --format json \
    --project monpec-sistema-rural | \
    jq -r '.[] | "\(.timestamp) [\(.severity)] \(.textPayload // .jsonPayload.message // "")"' | \
    tail -50

# 3. Ver logs da última execução específica (substitua XXXX pelo nome da execução)
# gcloud run jobs executions describe migrate-monpec-XXXX --region us-central1

# 4. Ver logs direto via gcloud logging (filtro por erro)
gcloud logging read "resource.type=cloud_run_job AND severity>=ERROR" \
    --limit 20 \
    --format="table(timestamp,severity,textPayload)" \
    --project monpec-sistema-rural

# 5. Ver configuração atual do job (verificar variáveis de ambiente e Cloud SQL)
gcloud run jobs describe migrate-monpec --region us-central1




