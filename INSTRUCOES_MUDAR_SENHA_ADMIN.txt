================================================================================
                    ğŸ” MUDANÃ‡A DE SENHA DO ADMIN - MONPEC
================================================================================

PROBLEMA: A senha atual "admin123" Ã© muito vulnerÃ¡vel e insegura.

SOLUÃ‡ÃƒO: Execute os comandos abaixo no GOOGLE CLOUD SHELL para alterar a senha.

================================================================================
                    ğŸš€ PASSOS PARA EXECUTAR
================================================================================

1. ACESSE O GOOGLE CLOUD SHELL:
   â€¢ VÃ¡ para: https://console.cloud.google.com/
   â€¢ Clique no Ã­cone do Cloud Shell (terminal) no topo direito
   â€¢ Aguarde o terminal carregar

2. COPIE E COLE TODO O SCRIPT ABAIXO NO CLOUD SHELL:

================================================================================
                    ğŸ“‹ SCRIPT PARA EXECUTAR
================================================================================

#!/bin/bash
# Script para mudar senha do admin no Google Cloud
# Execute no Google Cloud Shell

set -e

echo "ğŸ” MUDANÃ‡A DE SENHA DO ADMIN - MONPEC"
echo "======================================"

# ConfiguraÃ§Ãµes
PROJECT_ID="monpec-sistema-rural"
REGION="us-central1"
SERVICE_NAME="monpec"
CONNECTION_NAME="$PROJECT_ID:$REGION:monpec-db"

# SENHA CONFIGURADA: L6171r12@@monpec (depois serÃ¡ mudada para L6171r12@@js)
NOVA_SENHA="L6171r12@@monpec"

echo "ğŸ“ Senha configurada: $NOVA_SENHA"
echo "âœ… Senha validada!"
echo ""

# Configurar projeto
echo "ğŸ”§ Configurando projeto..."
gcloud config set project $PROJECT_ID --quiet

# Executar mudanÃ§a de senha
echo "ğŸ”„ Executando mudanÃ§a de senha..."

gcloud run jobs create change-admin-password \
  --image gcr.io/$PROJECT_ID/$SERVICE_NAME \
  --region $REGION \
  --command python \
  --args -c,"
import os, django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'sistema_rural.settings_gcp')
django.setup()
from django.contrib.auth.models import User

print('ğŸ” Alterando senha do admin...')
admin_user = User.objects.filter(username='admin').first()
if admin_user:
    admin_user.set_password('$NOVA_SENHA')
    admin_user.save()
    print('âœ… Senha alterada com sucesso!')
    print('ğŸ‘¤ UsuÃ¡rio: admin')
    print('ğŸ“§ Email: admin@monpec.com.br')
else:
    print('âŒ UsuÃ¡rio admin nÃ£o encontrado!')
" \
  --set-env-vars "DJANGO_SETTINGS_MODULE=sistema_rural.settings_gcp,DB_NAME=monpec_db,DB_USER=monpec_user,DB_PASSWORD=L6171r12@@jjms,CLOUD_SQL_CONNECTION_NAME=$CONNECTION_NAME" \
  --set-cloudsql-instances $CONNECTION_NAME \
  --max-retries 1 \
  --task-timeout 300 \
  --memory 512Mi \
  --cpu 1 \
  --quiet

# Executar job
echo "â±ï¸  Executando..."
gcloud run jobs execute change-admin-password --region $REGION --wait

# Limpar job
gcloud run jobs delete change-admin-password --region $REGION --quiet 2>&1 || true

echo ""
echo "ğŸ‰ SENHA ALTERADA COM SUCESSO!"
echo "================================"
echo ""
echo "ğŸŒ URLs de acesso:"
echo "   â€¢ https://monpec.com.br/login/"
echo "   â€¢ https://monpec-29862706245.us-central1.run.app/login/"
echo ""
echo "ğŸ‘¤ Credenciais:"
echo "   UsuÃ¡rio: admin"
echo "   Email: admin@monpec.com.br"
echo "   Senha: L6171r12@@monpec"
echo ""
echo "ğŸ“ PRÃ“XIMO PASSO:"
echo "   Execute novamente este script alterando a linha:"
echo "   NOVA_SENHA=\"L6171r12@@monpec\""
echo "   Para:"
echo "   NOVA_SENHA=\"L6171r12@@js\""
echo ""
echo "âš ï¸ IMPORTANTE:"
echo "   â€¢ Anote sua senha atual: L6171r12@@monpec"
echo "   â€¢ A senha antiga (admin123) nÃ£o funciona mais!"
echo ""
echo "âœ… Processo concluÃ­do!"

================================================================================
                    ğŸ“ EXEMPLO DE SENHA SEGURA
================================================================================

Algumas sugestÃµes de senhas fortes:

âœ… Boas opÃ§Ãµes:
   â€¢ Monpec@2025!Admin
   â€¢ SistemaRural@2025#
   â€¢ Pecuaria@Admin2025!
   â€¢ L6171r12@@Admin
   â€¢ AdminMonpec@2025$

âŒ Evite estas:
   â€¢ admin123 (muito simples)
   â€¢ 12345678 (sequencial)
   â€¢ password (comum)
   â€¢ monpec (relacionada ao sistema)

================================================================================
                    ğŸ” COMO VERIFICAR SE FUNCIONOU
================================================================================

ApÃ³s executar o script:

1. Acesse: https://monpec.com.br/login/
2. Use as credenciais:
   â€¢ UsuÃ¡rio: admin
   â€¢ Senha: [sua nova senha]
3. Deve fazer login normalmente

Se ainda der erro, pode ser necessÃ¡rio executar primeiro a correÃ§Ã£o do erro 500.

================================================================================
                    ğŸš¨ EM CASO DE PROBLEMAS
================================================================================

Se o script falhar:

1. Verifique se vocÃª estÃ¡ no Google Cloud Shell correto
2. Certifique-se de que o projeto "monpec-sistema-rural" estÃ¡ selecionado
3. Execute: gcloud config get-value project (deve retornar "monpec-sistema-rural")

4. Se ainda nÃ£o funcionar, execute primeiro a correÃ§Ã£o do erro 500 mencionada anteriormente

================================================================================
                    ğŸ”„ SCRIPT PARA SEGUNDA SENHA (L6171r12@@js)
================================================================================

Quando quiser mudar para a senha final, use este script:

#!/bin/bash
# Script para mudar senha do admin para L6171r12@@js
set -e

echo "ğŸ” MUDANÃ‡A PARA SENHA FINAL - MONPEC"

PROJECT_ID="monpec-sistema-rural"
REGION="us-central1"
SERVICE_NAME="monpec"
CONNECTION_NAME="$PROJECT_ID:$REGION:monpec-db"

# SENHA FINAL: L6171r12@@js
NOVA_SENHA="L6171r12@@js"

echo "ğŸ“ Senha final configurada: $NOVA_SENHA"
echo "âœ… Senha validada!"

gcloud config set project $PROJECT_ID --quiet
echo "ğŸ”„ Executando mudanÃ§a de senha..."

gcloud run jobs create change-admin-password-final \
  --image gcr.io/$PROJECT_ID/$SERVICE_NAME \
  --region $REGION \
  --command python \
  --args -c,"
import os, django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'sistema_rural.settings_gcp')
django.setup()
from django.contrib.auth.models import User

print('ğŸ” Alterando para senha final...')
admin_user = User.objects.filter(username='admin').first()
if admin_user:
    admin_user.set_password('$NOVA_SENHA')
    admin_user.save()
    print('âœ… Senha final definida!')
else:
    print('âŒ UsuÃ¡rio admin nÃ£o encontrado!')
" \
  --set-env-vars "DJANGO_SETTINGS_MODULE=sistema_rural.settings_gcp,DB_NAME=monpec_db,DB_USER=monpec_user,DB_PASSWORD=L6171r12@@jjms,CLOUD_SQL_CONNECTION_NAME=$CONNECTION_NAME" \
  --set-cloudsql-instances $CONNECTION_NAME \
  --max-retries 1 \
  --task-timeout 300 \
  --memory 512Mi \
  --cpu 1 --quiet

gcloud run jobs execute change-admin-password-final --region $REGION --wait
gcloud run jobs delete change-admin-password-final --region $REGION --quiet 2>&1 || true

echo ""
echo "ğŸ‰ SENHA FINAL DEFINIDA!"
echo "ğŸ‘¤ UsuÃ¡rio: admin"
echo "ğŸ“§ Email: admin@monpec.com.br"
echo "ğŸ”‘ Senha: L6171r12@@js"
echo "ğŸŒ https://monpec.com.br/login/"

================================================================================
                    âœ… PRONTO PARA USAR!
================================================================================