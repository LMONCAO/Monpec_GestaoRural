{% extends 'base_modulos_unificado.html' %}
{% load formatacao_br %}

{% block title %}Propriedades - {{ produtor.nome }}{% endblock %}

{% block breadcrumb_extra %}
<li class="breadcrumb-item active">Propriedades</li>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Cabeçalho da Página -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">
                Propriedades
            </h2>
            <p class="text-muted mb-0">Produtor: {{ produtor.nome }}</p>
        </div>
        <a href="{% url 'propriedade_nova' produtor.id %}" class="btn btn-primary">
            <i class="bi bi-plus-circle me-2"></i>Adicionar Nova Propriedade
        </a>
    </div>

    <!-- Lista de Propriedades -->
    {% if propriedades %}
    <div class="row">
        {% for propriedade in propriedades %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">{{ propriedade.nome_propriedade }}</h5>
                </div>
                
                <div class="card-body">
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-geo-alt me-1"></i>Localização
                        </small>
                        <strong>{{ propriedade.municipio }}/{{ propriedade.uf }}</strong>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-rulers me-1"></i>Área Total
                        </small>
                        <strong>{{ propriedade.area_total_ha|numero_br:2 }} ha</strong>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-tags me-1"></i>Tipo
                        </small>
                        <span class="badge bg-primary">
                            {{ propriedade.get_tipo_operacao_display }}
                        </span>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-diagram-3 me-1"></i>Ciclos Pecuários
                        </small>
                        <strong>{{ propriedade.get_ciclos_pecuarios_display }}</strong>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-building me-1"></i>Propriedade
                        </small>
                        <strong>{{ propriedade.get_tipo_propriedade_display }}</strong>
                    </div>
                    {% if propriedade.tipo_propriedade == 'PROPRIA' and propriedade.valor_total_propriedade %}
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-cash-stack me-1"></i>Valor Total
                        </small>
                        <strong class="text-success">{{ propriedade.valor_total_propriedade|moeda_br }}</strong>
                    </div>
                    {% elif propriedade.tipo_propriedade == 'ARRENDAMENTO' and propriedade.valor_mensal_total_arrendamento %}
                    <div class="mb-3">
                        <small class="text-muted d-block mb-1">
                            <i class="bi bi-calendar-month me-1"></i>Arrendamento
                        </small>
                        <strong class="text-warning">{{ propriedade.valor_mensal_total_arrendamento|moeda_br }}/mês</strong>
                    </div>
                    {% endif %}
                    
                    <div class="d-grid gap-2 mt-3">
                        <a href="{% url 'propriedade_modulos' propriedade.id %}" class="btn btn-primary">
                            <i class="bi bi-grid-3x3-gap-fill me-2"></i>
                            <strong>Acessar Funcionalidades</strong>
                        </a>
                        <small class="text-muted text-center">
                            <i class="bi bi-info-circle me-1"></i>
                            Pecuária, Financeiro, Projetos e muito mais
                        </small>
                    </div>
                    
                    <div class="d-flex gap-2 mt-3">
                        <a href="{% url 'propriedade_editar' propriedade.id %}" class="btn btn-outline-primary flex-fill">
                            <i class="bi bi-pencil me-1"></i> Editar
                        </a>
                        <a href="{% url 'propriedade_excluir' propriedade.id %}" class="btn btn-outline-danger flex-fill">
                            <i class="bi bi-trash me-1"></i> Excluir
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="card">
        <div class="card-body text-center py-5">
            <h3 class="mb-3">Nenhuma propriedade cadastrada</h3>
            <p class="text-muted mb-4">Comece adicionando uma nova propriedade para este produtor.</p>
            <a href="{% url 'propriedade_nova' produtor.id %}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-2"></i>Adicionar Primeira Propriedade
            </a>
        </div>
    </div>
    {% endif %}
    
    <div class="mt-4 d-flex gap-2">
        <a href="{% url 'dashboard' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-2"></i>Voltar ao Dashboard
        </a>
        <a href="{% url 'propriedades_lista' produtor.id %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-clockwise me-2"></i>Atualizar Lista
        </a>
    </div>
</div>
{% endblock %}
